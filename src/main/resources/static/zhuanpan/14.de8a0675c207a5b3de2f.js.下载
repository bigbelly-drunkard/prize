webpackJsonp([14],{T2DR:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("pwft"),r=i("3FMC"),n=i("K9/F"),a=i("QtDR"),o=i("CMFd"),c=i("bMVv"),l={name:"dazhuanpan1",components:{applyDialog:n.a,resultDialog:a.a,common:s.a,djs:r.a,introduction:o.a,bottom:c.a},data:function(){return{centerOrigin:0,canvasLength:0,fontSize:0,runRotate:0,is_complete:!1,prizes:[],lottery:[],is_draw:!1}},methods:{getLottery:function(){var t=this;this.$http.get("mobile/getLottery").then(function(e){document.title=e.lottery.act_name,t.prizes=e.lottery.prizes,t.lottery=e.lottery,t.initDraw(),t.initData()})},initData:function(){var t=this;this.$refs.djs.setData(this.lottery.djs),this.$refs.intro.setData(this.lottery),this.$refs.apply.setData(this.lottery),this.$refs.common.lottery=this.lottery,this.$refs.bottom.hide_adv=this.lottery.hide_adv,setTimeout(function(){t.$refs.common.show_loading=!1},300)},doDraw:function(){var t=this;1!=this.is_draw&&(0!=this.lottery.draw_amount?(this.is_draw=!0,this.$http.get("mobile/doDraw").then(function(e){return 102==e.flag?(t.is_draw=!1,void(t.$refs.apply.apply_dialog=!0)):103==e.flag?(t.is_draw=!1,void t.$refs.common.showCode()):100!=e.flag?(t.is_draw=!1,void t.$toast.fail(e.msg)):void t.doAction(e)})):this.$toast.fail("抽奖次数已用完！"))},doAction:function(t){for(var e=this,i=t.prize.id,s=0;s<this.prizeNum;s++){if(this.prizes[s].id==i){var r=s;break}}var n=3600+360/this.prizeNum*(this.prizeNum-r);this.runRotate=n,setTimeout(function(){e.$refs.result.setPrize(t.prize),e.is_draw=!1},6e3)},initDraw:function(){var t=this,e=getComputedStyle(window.document.documentElement)["font-size"];e=parseFloat(e),this.fontSize=e,this.centerOrigin=4*e,this.canvasLength=8*e,setTimeout(function(){for(var e=document.getElementById("myCanvas").getContext("2d"),i=t.prizeNum,s=360/i/2+90,r=0;r<i;r++){e.save(),e.beginPath(),e.translate(t.centerOrigin,t.centerOrigin),e.moveTo(0,0),e.rotate((360/i*r-s)*Math.PI/180),e.arc(0,0,3.2*t.fontSize,0,2*Math.PI/i,!1);var n=["#D7D7D7","#FEF43E","#EF7683"][r%3];e.fillStyle=n,e.fill(),e.lineWidth=.5,e.strokeStyle="#e4370e",e.stroke(),e.restore()}t.is_complete=!0},100)}},created:function(){this.getLottery()},computed:{prizeNum:function(){return this.prizes.length}},filters:{}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dazhuanpan1"},[i("common",{ref:"common"}),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"turntable"},[i("div",{staticClass:"bg"}),t._v(" "),i("div",{staticClass:"zhuanpan",style:{transformOrigin:t.centerOrigin+"px "+t.centerOrigin+"px",transform:"rotate("+t.runRotate+"deg)"}},[i("canvas",{staticClass:"canvas",attrs:{id:"myCanvas",width:t.canvasLength,height:t.canvasLength}}),t._v(" "),i("div",{staticClass:"secs"},t._l(t.prizes,function(e,s){return i("div",{staticClass:"sec",style:{transform:"rotate("+360*s/t.prizeNum+"deg)",transformOrigin:t.centerOrigin+"px "+t.centerOrigin+"px"}},[i("div",[t._v(t._s(e.name))]),t._v(" "),e.picture?i("div",{staticClass:"img"},[i("img",{attrs:{src:e.picture}})]):t._e()])}),0)]),t._v(" "),i("div",{staticClass:"but"},[i("img",{attrs:{src:"//cdn.choujiangle.cn/themes/theme1/button.png"},on:{click:t.doDraw}})])]),t._v(" "),i("div",{staticClass:"jihui"},[t._v("\n    您还有"),i("span",[t._v(" "+t._s(t.lottery.draw_amount)+" ")]),t._v("次机会\n  ")]),t._v(" "),i("djs",{ref:"djs"}),t._v(" "),i("introduction",{ref:"intro"}),t._v(" "),i("bottom",{ref:"bottom"}),t._v(" "),i("applyDialog",{ref:"apply"}),t._v(" "),i("resultDialog",{ref:"result"})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("img",{attrs:{src:"//cdn.choujiangle.cn/themes/theme1/lottery.png"}})])}]};var u=i("C7Lr")(l,d,!1,function(t){i("WpE6")},null,null);e.default=u.exports},WpE6:function(t,e){}});
//# sourceMappingURL=14.de8a0675c207a5b3de2f.js.map